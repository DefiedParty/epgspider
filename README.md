# ç”µè§†èŠ‚ç›®æ¸…å•çˆ¬è™«

## ä½¿ç”¨
- å®‰è£…Scrapy

    `pip install Scrapy`

- å®‰è£… jq
    
    `sudo apt-get install jq`

    è¯¦è§ [Download jq](https://stedolan.github.io/jq/download/)

- å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°

    `git clone https://github.com/DefiedParty/epgspider`

- ç»™ğŸ‘´çˆ¬

    `scrapy crawl epgjson -a chname=jxtv -a chNameCN=æ±Ÿè¥¿å«è§† -a targetDate=2021-01-19 -a fileName=å•Šå§å•Šå§.json`

---

## æ‰©å±•è„šæœ¬

`bash ./epg_get.sh n m`

`n` æŒ‡å®šäº†çˆ¬å–å¤šå°‘å¤©å†…çš„èŠ‚ç›®å•

`m` æŒ‡å®šæ˜¯å¦éœ€è¦åˆå¹¶

**ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š**

è¿™æ˜¯é¡¹ç›®ç›®å½•ä¸‹çš„ `channel_list.cfg` ï¼š
    
    CCTV1 cctv1
    æ²³å—å«è§† hatv
    é™•è¥¿å«è§† sntv
    æ±Ÿè¥¿å«è§† jxtv

å½“å‰ç³»ç»Ÿæ—¶é—´ï¼š2021-05-28

æ‰§è¡Œ `bash ./epg_get.sh 2` å°†åœ¨é¡¹ç›®ç›®å½•ä¸‹ç”Ÿæˆä¸‹åˆ—æ–‡ä»¶ï¼š

    æ²³å—å«è§† 2021-05-27.json
    æ²³å—å«è§† 2021-05-28.json
    æ±Ÿè¥¿å«è§† 2021-05-27.json
    æ±Ÿè¥¿å«è§† 2021-05-28.json
    é™•è¥¿å«è§† 2021-05-27.json
    é™•è¥¿å«è§† 2021-05-28.json
    CCTV1 2021-05-27.json
    CCTV1 2021-05-28.json

å¦‚æœæ·»åŠ å‚æ•° `m`

`bash ./epg_get.sh 2 m`

é‚£ä¹ˆåœ¨é¡¹ç›®ç›®å½•ä¸‹ä»…ç”Ÿæˆä¸€ä¸ªåˆå¹¶åçš„ `fullepgs.json`

---

## è¯´æ˜

- `chname` æŒ‡å®šäº†é”®ï¼Œå¯éšæ„è®¾ç½®

- `chNameCN` æ„ä¸ºâ€œé¢‘é“åâ€ï¼Œç”¨äºè¯·æ±‚æ•°æ®ï¼Œæœ‰ç¡®å®šæ€§

- `targetDate` æ„ä¸ºâ€œè¯·æ±‚æ¸…å•æ—¥æœŸâ€ï¼Œç”¨äºè¯·æ±‚æ•°æ®

**æ³¨æ„ï¼**  `fileName` ä¸ºéå¿…é€‰é¡¹ï¼

è¿è¡Œç»“æŸåä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆ `fullepg.json` ,æ ¼å¼å¦‚ä¸‹ï¼š

    {
        "jxtv": [
            {
                "start": 1610994900,
                "stop": 1611000300,
                "title": "\u7eaa\u5f55\u7247"
            },
            {
                "start": 1611000300,
                "stop": 1611009600,
                "title": "\u6df1\u591c\u5267\u573a"
            },
            {
                "start": 1611009600,
                "stop": 1611010800,
                "title": "\u6c5f\u897f\u65b0\u95fb\u8054\u64ad"
            },
            .......
            {
                "start": 1611069900,
                "stop": 1611071999,
                "title": "\u7cbe\u54c1\u5267\u573a"
            }
        ]
    }
